<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŠè§£ - ä¸ {{ receiver_username }} çš„èŠå¤©</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chat.css') }}">
    <link rel="stylesheet" href="{{url_for('static',filename='css/sidebar.css')}}">
</head>
<body>
    <div id="container">
        <!-- ä¾§è¾¹æ  -->
       <nav class="sidebar">
           <div class="profile">
            <img src="{{ url_for('static', filename='img/qingwalogo.jpg') }}" alt="Profile Picture" id="sidebar-avatar">
               <h2>{{ username if username else "Guest" }}</h2>
           </div>
           <ul>
               <li><a href="{{ url_for('index') }}">é¦–é¡µ</a></li>
               <li><a href="{{ url_for('personal') }}">ä¸ªäººä¸­å¿ƒ</a></li>
               <li><a href="{{ url_for('shanlian') }}">æ±•æ‹</a></li>
               <li><a href="{{ url_for('chat') }}">èŠè§£</a></li>
               <li><a href="{{url_for('blindbox')}}">ç›²ç›’äº¤å‹</a></li>
               {% if username %}
                   <li><a href="{{ url_for('logout') }}">æ³¨é”€</a></li>
               {% else %}
                   <li><a href="{{ url_for('login') }}">ç™»å½•</a></li>
                   <li><a href="{{ url_for('register') }}">æ³¨å†Œ</a></li>
               {% endif %}
           </ul>
       </nav>
    </div>

    <div class="container1">
        <div class="sidebar1">
            <h2>èŠå¤©åˆ—è¡¨</h2>
            <!-- å¥½å‹åˆ—è¡¨ -->
            <h3>å¥½å‹åˆ—è¡¨</h3>
            <ul id="friend-list" class="friend-list">
                {% for friend in friends %}
                    <li data-chat-id="{{ friend.id }}">
                        <span class="friend-item">{{ friend.username }}</span>
                    </li>
                {% endfor %}
            </ul>   

            <form id="addFriendForm" onsubmit="event.preventDefault(); addFriend();">
                <input type="text" id="phone_number" placeholder="è¾“å…¥å¥½å‹æ‰‹æœºå·" required>
                <button type="submit">æ·»åŠ å¥½å‹</button>
            </form>                                  
        </div>

        <div class="chat-area">
            <div class="chat-header" id="chat-header">
                <h3>é€‰æ‹©èŠå¤©å¯¹è±¡</h3>
                {% if receiver_username %}
                    <h3>ä¸ {{ receiver_username }} çš„èŠå¤©</h3>
                {% endif %}
            </div>

            <div class="chat-messages" id="chat-messages">
                {% if messages %}
                    {% for message in messages %}
                        <div class="message">
                            <p>{{ message.content }}</p>
                            <span>{{ message.timestamp }}</span>
                        </div>
                    {% endfor %}
                {% else %}
                    <p>æ²¡æœ‰èŠå¤©è®°å½•</p>
                {% endif %}
            </div>

            <form method="POST" action="/chat?receiver_id={{ receiver_id }}" class="chat-input" onsubmit="sendMessage(event)">
                <button type="button" class="emoji-button" onclick="toggleEmojiPicker()">ğŸ˜Š</button>
                <div class="emoji-picker" id="emoji-picker">
                    <!-- è¡¨æƒ…ç¬¦å· -->
                    <span onclick="addEmoji('ğŸ˜€')">ğŸ˜€</span>
                    <span onclick="addEmoji('ğŸ˜')">ğŸ˜</span>
                    <span onclick="addEmoji('ğŸ˜‚')">ğŸ˜‚</span>
                    <span onclick="addEmoji('ğŸ¤£')">ğŸ¤£</span>
                    <span onclick="addEmoji('ğŸ˜ƒ')">ğŸ˜ƒ</span>
                    <span onclick="addEmoji('ğŸ˜„')">ğŸ˜„</span>
                    <span onclick="addEmoji('ğŸ˜†')">ğŸ˜†</span>
                    <span onclick="addEmoji('ğŸ˜…')">ğŸ˜…</span><br>
    
                    <span onclick="addEmoji('ğŸ˜œ')">ğŸ˜œ</span>
                    <span onclick="addEmoji('ğŸ˜')">ğŸ˜</span>
                    <span onclick="addEmoji('ğŸ˜›')">ğŸ˜›</span>
                    <span onclick="addEmoji('ğŸ˜')">ğŸ˜</span>
                    <span onclick="addEmoji('ğŸ¤“')">ğŸ¤“</span>
                    <span onclick="addEmoji('ğŸ¤—')">ğŸ¤—</span>
                    <span onclick="addEmoji('ğŸ˜º')">ğŸ˜º</span>
                    <span onclick="addEmoji('ğŸ˜»')">ğŸ˜»</span><br>
    
                    <span onclick="addEmoji('ğŸ˜½')">ğŸ˜½</span>
                    <span onclick="addEmoji('ğŸ˜¾')">ğŸ˜¾</span>
                    <span onclick="addEmoji('ğŸ¤ ')">ğŸ¤ </span>
                    <span onclick="addEmoji('ğŸ˜ˆ')">ğŸ˜ˆ</span>
                    <span onclick="addEmoji('ğŸ‘¿')">ğŸ‘¿</span>
                    <span onclick="addEmoji('ğŸ˜œ')">ğŸ˜œ</span>
                    <span onclick="addEmoji('ğŸ˜¤')">ğŸ˜¤</span>
                    <span onclick="addEmoji('ğŸ˜±')">ğŸ˜±</span><br>
    
                    <span onclick="addEmoji('ğŸ˜³')">ğŸ˜³</span>
                    <span onclick="addEmoji('ğŸ˜”')">ğŸ˜”</span>
                    <span onclick="addEmoji('ğŸ¤¤')">ğŸ¤¤</span>
                    <span onclick="addEmoji('ğŸ¤¢')">ğŸ¤¢</span>
                    <span onclick="addEmoji('ğŸ¤§')">ğŸ¤§</span>
                    <span onclick="addEmoji('ğŸ¥º')">ğŸ¥º</span>
                    <span onclick="addEmoji('ğŸ¤©')">ğŸ¤©</span>
                    <span onclick="addEmoji('ğŸ¥³')">ğŸ¥³</span><br>
    
                    <span onclick="addEmoji('ğŸ˜¤')">ğŸ˜¤</span>
                    <span onclick="addEmoji('ğŸ˜…')">ğŸ˜…</span>
                    <span onclick="addEmoji('ğŸ¥µ')">ğŸ¥µ</span>
                    <span onclick="addEmoji('ğŸ¥¶')">ğŸ¥¶</span>
                    <span onclick="addEmoji('ğŸ˜»')">ğŸ˜»</span>
                    <span onclick="addEmoji('ğŸ’€')">ğŸ’€</span>
                    <span onclick="addEmoji('ğŸ‘»')">ğŸ‘»</span>
                    <span onclick="addEmoji('ğŸ¤–')">ğŸ¤–</span><br>
    
                    <span onclick="addEmoji('ğŸ¦„')">ğŸ¦„</span>
                    <span onclick="addEmoji('ğŸ±')">ğŸ±</span>
                    <span onclick="addEmoji('ğŸ¶')">ğŸ¶</span>
                    <span onclick="addEmoji('ğŸ·')">ğŸ·</span>
                    <span onclick="addEmoji('ğŸ¸')">ğŸ¸</span>
                    <span onclick="addEmoji('ğŸµ')">ğŸµ</span>
                    <span onclick="addEmoji('ğŸ¦Š')">ğŸ¦Š</span>
                    <span onclick="addEmoji('ğŸ®')">ğŸ®</span><br>
    
                    <span onclick="addEmoji('ğŸ¼')">ğŸ¼</span>
                    <span onclick="addEmoji('ğŸ¦')">ğŸ¦</span>
                    <span onclick="addEmoji('ğŸ¦„')">ğŸ¦„</span>
                    <span onclick="addEmoji('ğŸ¦’')">ğŸ¦’</span>
                    <span onclick="addEmoji('ğŸ§')">ğŸ§</span>
                    <span onclick="addEmoji('ğŸ¦')">ğŸ¦</span>
                    <span onclick="addEmoji('ğŸ¤')">ğŸ¤</span>
                    <span onclick="addEmoji('ğŸ¦‹')">ğŸ¦‹</span><br>
    
                    <span onclick="addEmoji('ğŸ')">ğŸ</span>
                    <span onclick="addEmoji('ğŸŒ')">ğŸŒ</span>
                    <span onclick="addEmoji('ğŸ')">ğŸ</span>
                    <span onclick="addEmoji('ğŸ¦')">ğŸ¦</span>
                    <span onclick="addEmoji('ğŸ¦€')">ğŸ¦€</span>
                    <span onclick="addEmoji('ğŸ¡')">ğŸ¡</span>
                    <span onclick="addEmoji('ğŸ¦‘')">ğŸ¦‘</span>
                    <span onclick="addEmoji('ğŸ™')">ğŸ™</span><br>
    
                    <span onclick="addEmoji('ğŸš')">ğŸš</span>
                    <span onclick="addEmoji('ğŸ¦')">ğŸ¦</span>
                    <span onclick="addEmoji('ğŸ¦§')">ğŸ¦§</span>
                    <span onclick="addEmoji('ğŸ¦¦')">ğŸ¦¦</span>
                    <span onclick="addEmoji('ğŸ¦¡')">ğŸ¦¡</span>
                    <span onclick="addEmoji('ğŸ¦Œ')">ğŸ¦Œ</span>
                    <span onclick="addEmoji('ğŸ¦”')">ğŸ¦”</span>
                    <span onclick="addEmoji('ğŸ¾')">ğŸ¾</span>
                    <hr>
                </div>
                <textarea id="message-input" rows="1" placeholder="è¾“å…¥æ¶ˆæ¯..."></textarea>
                <button type="submit" id="send-button">å‘é€</button>
            </form>

        </div>
    </div>

    <script src="{{ url_for('static', filename='js/chat.js') }}"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="{{ url_for('static', filename='js/select_avatar.js') }}"></script>
</body>
</html>
